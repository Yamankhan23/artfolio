name: Telegram Notify on Deploy

on:
  push:
    branches:
      - main

jobs:
  telegram_notify:
    runs-on: ubuntu-latest

    steps:
      - name: Send Telegram Notification (plain text, single-line)
        run: |
          NETLIFY_URL="https://artfolioyaman.netlify.app/"
          COMMIT_MSG=$(echo "${{ github.event.head_commit.message }}" | tr '\n' ' ')
          AUTHOR=${{ github.actor }}
          BRANCH=${{ github.ref_name }}
          REPO=${{ github.repository }}
          MESSAGE="âœ… Deployment Successful! Repo: $REPO | Branch: $BRANCH | Author: $AUTHOR | Commit: $COMMIT_MSG | View site: $NETLIFY_URL"
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d text="$MESSAGE"
